<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>MathWorld File Upload</title>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;600;700&display=swap" rel="stylesheet">

<style>
*{box-sizing:border-box;font-family:'Inter',sans-serif}
body{
margin:0;min-height:100vh;
background:linear-gradient(135deg,#1e3c72,#2a5298);
display:flex;justify-content:center;align-items:center
}
.upload-container{
background:#fff;max-width:540px;width:100%;
padding:35px;border-radius:18px;
box-shadow:0 20px 40px rgba(0,0,0,.25)
}
.title span{font-size:28px;font-weight:700}
p{color:#666;font-size:14px;margin:15px 0}
textarea{
width:100%;min-height:80px;padding:12px;
border-radius:10px;border:1px solid #ccc;
margin-bottom:18px
}
.upload-box{
border:2px dashed #2a5298;
padding:28px;text-align:center;
border-radius:15px;cursor:pointer
}
.upload-box input{display:none}
.submit-btn{
margin-top:20px;width:100%;
padding:14px;border:none;border-radius:12px;
background:linear-gradient(135deg,#1e3c72,#2a5298);
color:#fff;font-size:16px;font-weight:600;cursor:pointer
}
.uploads-list{margin-top:25px}
.upload-item{
background:#f3f6ff;border-left:5px solid #2a5298;
padding:12px;border-radius:10px;margin-bottom:12px
}
.upload-desc{font-weight:600;color:#1e3c72}
.upload-file{font-size:13px;margin-top:5px}
.delete-btn{
margin-top:6px;background:#e63946;
border:none;color:#fff;
padding:6px 10px;border-radius:6px;
font-size:12px;cursor:pointer
}
.admin-bar{
text-align:right;margin-bottom:10px
}
.admin-btn{
background:#2a5298;color:#fff;
border:none;padding:6px 10px;
border-radius:6px;font-size:12px;cursor:pointer
}
.footer-text{
margin-top:20px;font-size:12px;
text-align:center;color:#555
}
.creator{font-weight:600;color:#1e3c72}
</style>
</head>

<body>
<div class="upload-container">

<div class="admin-bar">
<button class="admin-btn" onclick="adminLogin()">Admin Login</button>
</div>

<div class="title">
<span style="color:#e63946;">M</span>
<span style="color:#f4a261;">a</span>
<span style="color:#2a9d8f;">t</span>
<span style="color:#264653;">h</span>
<span style="color:#6a4c93;">W</span>
<span style="color:#ff006e;">o</span>
<span style="color:#3a86ff;">r</span>
<span style="color:#8338ec;">l</span>
<span style="color:#fb5607;">d</span>
<span style="color:#1e3c72;"> Upload</span>
</div>

<p>Upload math research files with description</p>

<textarea id="description" placeholder="File description..."></textarea>

<label class="upload-box">
ðŸ“˜ Click to upload
<input type="file" id="fileInput" multiple>
</label>

<button class="submit-btn" onclick="handleUpload()">Upload Files</button>

<div class="uploads-list" id="uploadsList"></div>

<div class="footer-text">
Â© 2025 MathWorld<br>
<span class="creator">Page created by Irfan Ali</span>
</div>

</div>

<script>
const cloudName = "duwlnrk8p";
const uploadPreset = "mathworld_upload";
const STORAGE_KEY = "mathworld_uploads";
const ADMIN_PASSWORD = "mathworld123"; // CHANGE THIS
let isAdmin = sessionStorage.getItem("admin") === "true";

window.onload = () => {
const saved = JSON.parse(localStorage.getItem(STORAGE_KEY)) || [];
saved.forEach(addUploadToUI);
};

function adminLogin(){
const pass = prompt("Enter admin password:");
if(pass === ADMIN_PASSWORD){
isAdmin = true;
sessionStorage.setItem("admin","true");
alert("Admin mode enabled");
location.reload();
}else{
alert("Wrong password");
}
}

async function handleUpload(){
const desc=document.getElementById("description").value.trim();
const files=document.getElementById("fileInput").files;
if(!desc||files.length===0){alert("Missing data");return;}

for(const file of files){
const fd=new FormData();
fd.append("file",file);
fd.append("upload_preset",uploadPreset);

const res=await fetch(`https://api.cloudinary.com/v1_1/${cloudName}/raw/upload`,{
method:"POST",body:fd});
const data=await res.json();

const upload={id:Date.now()+Math.random(),description:desc,filename:file.name,url:data.secure_url};
saveUpload(upload);
addUploadToUI(upload);
}

document.getElementById("description").value="";
document.getElementById("fileInput").value="";
}

function saveUpload(upload){
const all=JSON.parse(localStorage.getItem(STORAGE_KEY))||[];
all.unshift(upload);
localStorage.setItem(STORAGE_KEY,JSON.stringify(all));
}

function deleteUpload(id){
let all=JSON.parse(localStorage.getItem(STORAGE_KEY))||[];
all=all.filter(u=>u.id!==id);
localStorage.setItem(STORAGE_KEY,JSON.stringify(all));
location.reload();
}

function addUploadToUI(upload){
const list=document.getElementById("uploadsList");
const item=document.createElement("div");
item.className="upload-item";

item.innerHTML=`
<div class="upload-desc">${upload.description}</div>
<div class="upload-file">
ðŸ“„ ${upload.filename}<br>
<a href="${upload.url}" target="_blank">â¬‡ Download</a>
${isAdmin?`<br><button class="delete-btn" onclick="deleteUpload(${upload.id})">Delete</button>`:""}
</div>
`;
list.appendChild(item);
}
</script>
</body>
</html>
